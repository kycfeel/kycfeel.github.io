---
layout: post
title:  "HollaEx로 나만의 암호화폐 거래소 만들기"
date:   2019-10-31 16:01:45 +0900
categories: HollaEx
---

![nyancoin](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/nyancoin.gif?raw=true)

글쎄 말이다. 사람들은 암호화폐가 보이지 않는 허상이라고 하는데, 그 말에 정면으로 반박하듯 관련 산업은 나날이 커지고 있다. 업계가 무르익고 기술이 무르익으며, 이제 클릭 몇 번, 키보드 타이밍 몇 번이면 나만의 암호화폐 거래소도 열 수 있는 시대가 되었다. 이게 무슨 소리냐고? 바로 [HollaEx](https://bitholla.com/hollaex-kit/) 얘기다. 

HollaEx는 필자가 몸담아 일하고 있는 [bitHolla](https://bitholla.com) 에서 만든 암호화폐 거래소 솔루션이다. 뭐, 기술적으로는 암호화폐 거래소 뿐만 아니라 거래를 필요로 하는 모든 분야에 사용할 수 있지만, 어쨋든 그렇다. HollaEx를 사용하면 암호화폐 거래소를 만들 기술이나 기반이 부족하더라도, 약간의 노력만 기울이면 나만의 거래소를 뚝딱 만들 수 있다는 말씀. HollaEx 자체는 1~2년 전에도 존재했고, 진작부터 HollaEx를 사용해 만들어진 실제 거래소도 있지만, 이번 리뉴얼을 거치며 그 접근성을 한껏 끌어올렸다. 

필자를 포함한 팀원들의 오랜 노력과 쌓인 경험을 기반으로, HollaEx는 거래소를 열기 위한 모든것이 들어있는 키트 형태로 탈바꿈했다. 생존 키트를 열면 깊은 지식이 없는 사람이라도 극한 환경에서 살아남을 수 있는 것처럼, HollaEx 키트를 열면 깊은 지식이 없어도 내 거래소를 만들 수 있다 (사실 비유가 아니라, 정말로 이름이 HollaEx Kit인건 안비밀).

## 사용 준비
지금이라도 당장 누구나 GitHub에서 [HollaEx Kit](https://github.com/bitholla/hollaex-kit)를 살펴보고 다운로드 받을 수 있다. 

![hollaex_kit_main](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/hollaex_kit_main.png?raw=true)

다운로드를 다 받았다면, 안에 들어있는 여러 파일들 중 `install.sh` 가 보일건데, 바로 귀염뽀짝한 [HollaEx CLI](https://github.com/bitholla/hollaex-cli.git)를 설치하는 귀염뽀짝한 인스톨러다. 컴퓨터는 인간을 위해 존재하는 도구라 했던가, 이 CLI는 여러분이 어려워 할 거래소 초기 셋업부터 실제 실행, 이후의 유지보수까지 전부 도맡아서 도와줄 굉장히 엄청난 도구라고 하겠다. ~~절대 필자가 만들어서 띄워주는거 아니다~~

지금 이 글을 Linux 혹은 macOS에서 읽고 있다면, 아래 명령어를 통해 인스톨러를 실행시켜 바로 HollaEx CLI를 설치할 수 있다. 

```
bash install.sh
```

만약, 애석하게도 Windows라면, [이 문서](https://docs.bitholla.com/hollaex-kit/get-started#install-on-windows-beta)를 참조하자. 이 글을 쓰는 시점으로 아직은 프리뷰 단계인 [WSL 2](https://docs.microsoft.com/ko-kr/windows/wsl/wsl2-about)를 사용해 HollaEx Kit을 실행시킬 수 있다. 

무언가 주르륵 뜨고 대충 설치가 된 것 같다면, `hollaex version` 명령어를 실행해 보자. 아래와 같이 이쁜 HollaEx 로고와 버전 넘버가 출력된다면, 제대로 HollaEx CLI가 설치된 것이다. 

![hollaex_version](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/hollaex-version.png?raw=true)

여기까지 따라오셨다면 전체 과정의 20%는 끝낸 것이다. 정말이다. 남은 80%는 아래의 것들이 있다.

- **HollaEx 활성화 키** : 마치 Windows의 정품 키처럼, HollaEx 거래소를 활성화하기 위한 활성화 키다. 다행히 bitHolla는 HollaEx를 맛보고 싶은 사람들을 위해 15일의 무료체험 키를 제공하고 있다. [bitHolla 대시보드](https://dash.bitholla.com)에 회원가입을 하면 바로 발급받을 수 있으니 지금 들어가서 둘러보자.

- **Vault 지갑 연결용 API 키** (생략 가능) : [Vault](https://bitholla.com/vault/)는 HollaEx와 마찬가지로 bitHolla에서 만든 비즈니스용 암호화폐 지갑 서비스다. REST API를 제공하고 있어 누구나 자신의 서비스에 암호화폐 연동이 필요하다면 Vault를 가져다 사용할 수 있다. HollaEx도 물론 Vault를 암호화폐 연동에 사용한다. 이 얼마나 좋은 조합인가. 다만, 아쉽게도 **Vault는 HollaEx와 다르게 무료체험 키를 제공하지 않는다.** Vault가 없어도 HollaEx 구동 자체에는 문제가 없으니 비용을 지불하기 싫다면 일단 넘어가자. 

- **AWS** (생략 가능) : 물론 HollaEx의 작동에 AWS가 무조껀 필요한 것은 아니지만, 현재 버전의 HollaEx는 아쉽게도 AWS 서비스에 약간의 의존성을 띈다. HollaEx는 AWS 엑세스 키를 통해 S3 버킷에 유저 회원가입 문서 등을 저장하고, SES / SNS를 통해 유저 인증을 위한 이메일 / SMS를 발송한다. 이는 빠른 시일 안에 SMTP 지원 등을 통해 표준적인 방법으로 분리될 예정이지만, 현재로서는 AWS 서비스가 제한적으로 필요하다. 당장 AWS 계정이 없다면 생략할 수 있지만, **생략하면 이메일 발송 등의 기능이 먹통**이 되니 주의하자.

- **거래소 실행하기** : 위의 과정들은 전부 완벽히 작동하는 거래소를 실행하기 위한 도움닫기다. 모든 준비가 끝났다면, 최소한 거래소 얼굴이라도 보고 집에 들어가야지 않겠나? 

## HollaEx 활성화 키 발급하기 

HollaEx 활성화 키는 [bitHolla 대시보드](https://dash.bitholla.com)에서 클릭 몇 번이면 발급받을 수 있다. 

![HollaDash_main](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/hollaedash_main.png?raw=true)

좌측의 Product에서 HollaEx Kit 메뉴에 들어가면, "Create New Account" 라는 버튼이 있는데, 이미 우리는 무엇을 할 지 알고 있다. 일단 누르고 보자.

![cresting_exchange_activation_code](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/creating_exchange_key.png?raw=true)

내가 만들 거래소의 이름과 도메인 주소를 입력하자. 거래소 이름은 딱 하나밖에 없는 유니크 이름이 되니 주의해야 한다.

![click_trial](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/click_trial.png?raw=true)

Next를 누르면 당연히 내 잔액이 부족하다고 대시보드가 뭐라뭐라 혼내게 되는데, 우리는 어차피 지금은 돈 낼 생각이 없으므로(!) Begin Trial 버튼을 눌러 무료체험 신청을 해보자.

![key_generated](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/key_generated.png?raw=true)

짠. 더 이상 대시보드가 불평불만 없이 깔끔하게 무료체험 키를 토해냈다. 이걸로 활성화 키는 확보했다. 잊어버리기 전에 어딘가에 잘 복사해두자. 

## Vault 지갑 준비하기 (생략 가능)

Vault 지갑도 마찬가지로 같은 대시보드에서 세팅하고, 연결을 위한 API 키를 발급받을 수 있다. 좌측의 Product에서 Vault를 선택하자. Wallet 메뉴와 API Keys 메뉴가 보일 터인데, 우리가 지금 필요한 건 API 키이니, API Keys 메뉴로 들어가자. 안에 있는 "Generate API Key" 버튼으로 키를 생성할 수 있다.

![vault_key_generation](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/vault_key_generation.png?raw=true)

생성된 키를 마찬가지로 어딘가에 잘 복사해 두자. 파일 형태로도 다운로드 받을 수 있으니 참고할 것.

## AWS 설정하기 (생략 가능)

앞에 언급했다시피, 아직 HollaEx는 일부 기능에 대해 AWS에 의존성을 가지고 있다. 일부 자료 저장과 이메일, 그리고 SMS 발송을 위해서인데, 아래와 같은 AWS 서비스들이 해당된다.

- [AWS S3](https://aws.amazon.com/ko/s3/)
- [AWS SES](https://aws.amazon.com/ko/ses/)
- [AWS SNS](https://aws.amazon.com/ko/sns)

AWS 계정을 만들고, AWS S3 버킷을 생성하고, SES와 SNS를 생성하는 법은 다행히(?) AWS 측에서 잘 작성된 공식 문서를 제공하고 있다. 아래에 링크를 달아 두겠다. 굿 럭.


### 계정 생성

- [AWS 계정 만들기](https://aws.amazon.com/ko/premiumsupport/knowledge-center/create-and-activate-aws-account/)
- [AWS IAM 엑세스 키 만들기](https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_users_create.html)
생성한 IAM 엑세스 키로는 아래에 언급된 S3, SES, SNS에 모두 접근할 수 있는 권한을 가지고 있어야 한다.


### AWS S3 설정

- [AWS S3 버킷 만들기](https://docs.aws.amazon.com/ko_kr/AmazonS3/latest/user-guide/create-bucket.html)

거래소의 유저 정보가 저장되는 버킷인 만큼, 꼭 **Private 버킷**으로 설정해 줘야 한다!


### AWS SES 설정
- [AWS SES 빠른 시작](https://docs.aws.amazon.com/ko_kr/ses/latest/DeveloperGuide/getting-started.html)

AWS SES는 거래소에서 유저에게 이메일을 보낼 때 사용된다 (회원가입 인증 이메일 등). SES 설정에서 인증받아야 할 도메인은 내 거래소에서 실제로 사용할 도메인임을 기억해야 한다.


### AWS SNS 설정 

- [AWS SNS를 통한 SMS 메시지 전송](https://docs.aws.amazon.com/ko_kr/sns/latest/dg/sms_publish-to-phone.html)

## 거래소 초기 설정하기

자. 정말 수고하셨다. 간단할 것 같은데 간단하지 않았던 위 과정들을 모두 마친 당신은 이제 거래소를 마주볼 자격이 충분히 있다. 터미널을 하나 띄워서 아까 다운로드 받은 HollaEx Kit 경로로 이동하자.

이제 아래 명령어를 통해 거래소의 초기 설정을 진행할 수 있다.

> 진행하기 전 내 컴퓨터에 Docker와 Docker-Compose가 설치되어 있는 지 꼭 확인하자. 

```
hollaex setup
```

뒤이어서 내 거래소 이름, **활성화 키**, 사용할 도메인 주소 등 거래소에 필요한 필수 정보들을 입력할 수 있다. 질문에 따라 차근차근 정보를 집어넣으면 된다. 

진행하기 전 모든 정보가 올바른지 확인하는 것도 잊지 말자.

![hollaex_setup_confirmation](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/hollaex_setup_confirmation.png?raw=true)

기본 설정이 끝난다면, HollaEx CLI가 자동으로 거래소 컨테이너들을 생성하고 입력한 정보를 기반으로 초기 셋업을 돌릴 것이다. 모든 셋업 과정이 문제없이 끝난다면, 이제 추가적으로 내 거래소에서 사용할 코인과 거래 페어 (비트코인과 미국 달러의 거래장, 이더리움과 한국 원화의 거래장 등)를 마음대로 추가할 수 있다.

아래에서 `Y` 를 선택하고 다음으로 진행하면 된다.

### 새 코인 (화폐) 추가하기

![hollaex_setup_add_new_coin_and_pair](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/hollaex_setup_add_new_coin_pair.png?raw=true)

새 코인 추가를 선택한다면, 조금 전 거쳤던 `hollaex setup` 과 비슷한 질문들이 주르르 나온다. 코인 이름과 심볼 (비트코인이면 BTC 등) 과 같은 새 화폐에 필요한 정보들을 입력하는 창이니 신중하게 채워넣자.

여기서 말하는 코인은 실제 존재하는 것 뿐만 아니라 무엇이는 될 수 있다. 내가 새로나온 에어팟 프로가 가지고 싶다고 AirPodsProCoin 같은 괴상망측한 코인도 만들어버릴 수 있단 말씀. 만약 나만의 화폐를 꿈꾸고 있었다면, 지금이 기회다. 열심히 창의성을 발의해볼 것.

![add_coin_confirmation](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/add_coin_confirmation.png?raw=true)

모든 정보가 올바른지 다시한번 확인하고, `Y`를 선택하면 아래와 같이 내 거래소에 자동으로 새 코인이 추가된다.

![add_coin_process](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/add_coin_process.png?raw=true)

정상적으로 추가되었다면 HollaEx CLI가 아래와 같이 멋들어진 그래픽으로 친절히 알려준다. 

![add_coin_eht_success](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/add_coin_eth_success.png?raw=true)

### 새 거래 페어 (거래장) 추가하기

새 코인 추가를 모두 마쳤다면, 다음으로는 새 거래 페어를 추가할지 선택할 수 있다. 거래 페어는 당연하겠지만 이미 거래소에 존재하는 코인들만 사용해서 만들 수 있다. 아래와 같이 질문 폼을 채워넣자.

예를 들어, 이더리움과 USDT의 거래 페어를 만들고 싶다면, 아래와 같이 `eth-usdt` 와 같은 형태로 이름을 지어야 한다.

![add_pair_form](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/add_pair_form.png?raw=true)

모든 정보를 입력했다면, 위의 코인 추가와 비슷하게 `Y`를 선택하자. HollaEx CLI가 자동으로 거래 페어를 내 거래소에 추가해 줄 것이다.

정상적으로 추가되었다면 마찬가지로 CLI가 멋진 그래픽과 함께 친절히 알려준다. 

![add_pair_success](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/add_pair_success.png?raw=true)

## 거래소 실행하기

거래소에 필요한 정보를 다 집어넣고, 새 코인과 거래 페어까지 추가했으니, 직접 만나볼 차례다.

```
hollaex start
```

이 명령어 하나면 바로 내 컴퓨터에 거래소 서버가 실행된다. Docker 기반을 실행되는 만큼, `docker ps` 명령어를 통해 컨테이너 상태 등을 확인할 수 있다.

![hollaex_start](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/hollaex_start.png?raw=true)

짠. 뭔가 실행된 것 같이 보이지 않는가. 

이제 브라우저를 띄우고 초기 설정에서 입력한 내 도메인 주소를 쳐보자. 만약 DNS를 설정하지 않았다면, 지금이라도 내 DNS 설정에서 내 컴퓨터 (또는 서버)의 IP를 가르켜 주자. 만약 기본값과 같이 `localhost`로 설정했다면, `http://localhost` 주소로 거래소 API에 접근 할 수 있다.

`http://<내_도메인>/v1/health` 페이지에 접속해 거래소가 정상적으로 동작하는지, 활성화 상태는 어떤지 확인할 수 있다.

![hollaex_health_localhost](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/hollaex_health_localhost.png?raw=true)

`http://<내_도메인>/v1/constant` 주소로 접근하면 지금 내 거래소에 등록된 코인과 거래 페어 리스트를 볼 수 있다.

![hollaex_constant_localhost](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/hollaex_constant_localhost.png?raw=true)

Constant 정보까지 제대로 출력된다면, 거래소 서버가 정상적으로 동작되고 있다는 소리다. 축하한다. 우리는 방금 거래소 서버를 뚝딱 만들었다. 거래 채결 엔진부터 REST API, 웹소켓까지 전부 말이다. 짝짝짝

그런데, 뭔가 조금 부족하다. 분명 머릿속으로 거래소가 돌고 있다는 건 알지만, 눈에 보이지 않으니 아직 뭔가 빠진 것 같다. 그래서 준비했다. 거래소 웹 클라이언트.

## 거래소 웹 서버 띄우기

물론 REST API가 제공되니 원한다면 사용자가 처음부터 개발해 웹 클라이언트를 만들 수도 있겠지만, 우리한테 그럴 시간은 없다. 그렇다면? bitHolla에서 오픈 소스로 배포하는 기본 웹 클라이언트를 사용하면 된다. 이미 다운로드 받은 HollaEx Kit 폴더의 `/web` 폴더가 바로 웹 소스가 들어있는 곳이다. 사용자가 코드를 보고 씹고 뜯고 맛보고 즐기며 마음대로 커스터마이징도 가능하다.

다만, 지금은 일단 기본 코드 그대로 띄워보고 거래소가 제대로 동작하는지 느낌부터 받기로 하자. 

```
hollaex web --start
```

이 명령어로 `/web` 폴더의 소스를 빌드해 Docker 컨테이너로 만들고, 서버를 띄울 수도 있다. 

> 혹시라도 빌드 중 "Heap out of memory" 등의 에러가 발생한다면. 컴퓨터의 Docker 데몬에 할당된 메모리 상태를 체크하자. HollaEx 웹 클라이언트는 보기보다 꽤나 복잡한 과정을 거쳐 빌드된다. 이 과정에서 최소 4기가 이상의 메모리가 요구됨으로, 아래와 같이 메모리 할당량을 높혀주도록 하자. 

> ![dockerd_memory_allocation_configure](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/dockerd_memory_allocation_configure.png?raw=true)


빌드가 끝나고 정상적으로 웹이 실행된다면, 아래와 같은 안내 메시지가 뜰 것이다.

![hollaex_web_success](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/hollaex_web_success.png?raw=true)

안내 메시지처럼, 웹 클라이언트는 내가 설정한 도메인 혹은 localhost:8080 주소로 접근할 수 있다. 정상적으로 접근이 된다면, 아래처럼 제대로 웹 클라이언트가 브라우저에 보일 것이다. 테스트 로그인은 별도의 추가 회원가입 없이, `hollaex setup` 과정에서 생성한 Admin 계정으로 진행하면 편하다.

![hollaex_signin](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/web_client_login.png?raw=true)

짠. 정상적으로 로그인이 되었다면 아래와 같은 메인 페이지가 독자를 반겨줄 것이다. 

![web_successful_login](https://github.com/kycfeel/kycfeel.github.io/blob/master/_images/web_login_success.png?raw=true)

이제 정말로 완전한 거래소가 완성되었다. 만약 Vault 연결이나 AWS 연결을 하지 않았다면, 블록체인 네트워크에 암호화폐 지갑 생성, 혹은 유저 인증 이메일 발송 등은 제한되겠지만, Admin 페이지에서 내 계정에 잔액을 채운 후, 거래 페이지에서 자유롭게 내가 생성한 화폐와 거레 페어를 통해 테스트 거래가 가능하다. 

이제 HollaEx 웹을 커스터마이징 하거나, 거래 채결 기술만 API로 따와 다른 서비스에 사용하거나 하는 등 다양한 용도로 원하는 곳에 사용할 수 있다. 

## 추가 정보

HollaEx Kit와 HollaEx CLI를 다루는 더 자세한 방법, 모든 명령어 목록 등은 [bitHolla 공식 Docs](https://docs.bitholla.com)를 참고하면 된다. 내용은 실시간으로 업데이트 되니 참고할 것.

만약 진행 중 막히는 부분이 있거나, 추가 질문이 있다면, [bitHolla 포럼](https://forum.bitholla.com)에서 자유롭게 정보를 탐색하고 질문을 올릴 수 있다. 아무래도 다양한 곳에서 온 사람들이 사용하는 솔루션인 만큼, 더 양질의 정보를 위해 영어로 질문을 남겨야 하는 점은 기억하시라.

## 마치며

![coinpongpong](https://raw.githubusercontent.com/kycfeel/kycfeel.github.io/master/_images/coinpongpong.gif)

여기까지 따라오신 분들, 모두 수고하셨다. 이제 다들 거래소 하나씩은 끼고 다닐 수 있게 되었다. 그저 흔하디 흔한 미들웨어 설치 가이드 하나 따라온 것 같은 기분이 들겠지만, 그 결과가 내포하는 의미는 사실 완전히 다르다. 이전까지, 아니 지금까지도 금융이라는 것은 돈 있고 빽 있는 사람들의 체스판이였다. 은행, 주식판, 각종 거래소, 모든 것이 말이다. 우리는 그저 이미 다 짜여진 시스템 속에서 허우적거리고 있었을 뿐이다.

그런데, 암호화폐가 등장하면서 이런 당연한 것 같은 로직이 조금씩 깨지기 시작했다. 발행 주체가 없는 화폐. 그러면서도 누구도 무결성을 손댈 수 없는 화폐. 이 SF같은 이야기가 지난 10여넌 사이 우리에게는 현실이 되었다. 다만, 한가지 아킬레스 건이 있다. 이 자유로울 것 같은 화폐는 범용적으로 사용하기 위해 원화와 같은 기성 통화로 환전할 때 모든 자유가 사라진다. 자유가 사라지는 수준을 넘어 억압을 받고 있다 하는게 맞겠다. 각 국가의 법률, 메이저 거래소들의 정책 등 다양한 이유가 존재하겠지.

기껏 암호화폐라는 지푸라기는 잡았지만 다시금 허우적거리려는 우리에게, HollaEx는 한 줄기 지푸가리를 밧줄 정도로 바꿔줄 수 있는 솔루션이다. **더 쉬운 암호화폐 시장으로의 진입.** 이전에는 존재하지 않았을 다양한 비즈니스가 생겨나고, 다양한 거래소도 생겨난다. 이는 곧 우리같은 유저들에게는 *더 많은 선택권*을 의미한다. 더 많은 거래소, 더 많은 암호화폐 비즈니스. 이로 인해 처음 우리가 암호화폐를 마주했을 때 꿈꿨던 그 자유로움에 한 발자국 더 다가가지 않을까. 지금처럼 논란의 대상이 아닌, 무한한 미래를 가지고 있는 하나의 화폐로서 말이다. 

